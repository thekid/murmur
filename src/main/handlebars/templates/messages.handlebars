{{#each edges}}
  <div class="card">

    <!-- Type marker -->
    {{#match (type node)}}
      {{#case 'question'}}
        {{#if node.bestReply}}
          <a class="ui olive right corner label excerpt" data-html="<div class='header'>Best answer by {{node.bestReply.message.sender.displayName}}</div>{{body node.bestReply.message}}" data-variation="wide"><i class="compass icon"></i></a>
        {{else}}
          {{#if node.replies.totalCount}}
            <a class="ui teal right corner label excerpt" data-content="{{node.replies.totalCount}} answer(s), but none marked as accepted yet"><i class="compass icon"></i></a>
          {{else}}
            <a class="ui blue right corner label excerpt" data-content="No answer yet"><i class="compass icon"></i></a>
          {{/if}}
        {{/if}}
      {{/case}}

      {{#case 'announcement'}}
        <a class="ui orange right corner label excerpt" data-content="Announcement"><i class="rss icon"></i></a>
      {{/case}}

      {{#case 'poll'}}
        <a class="ui yellow right corner label excerpt" data-html="<div class='ui middle aligned relaxed divided list'>{{#each node.threadStarter.content.options}}<div class='item'><div class='right floated content'><a class='ui {{#if viewerHasSelected}}violet{{/if}} circular label'>{{voteCount}}</a></div><div class='content'>{{displayName}}</div></div>{{/each}}</div>" data-variation="wide"><i class="poll icon"></i></a>
      {{/case}}

      {{#case 'praise'}}
        <a class="ui pink right corner label excerpt" data-html="For {{#each node.threadStarter.content.users}}{{displayName}}{{#unless @last}}, {{/unless}}{{/each}}"><i class="heart icon"></i></a>
      {{/case}}
    {{/match}}

    <!-- Content -->
    <div class="content">
      <div class="header">New {{type node}} in <a href="https://web.yammer.com/main/groups/{{node.group.id}}">{{node.group.displayName}}</a></div>
      <div class="meta">
        <span class="date"><a title="{{node.databaseId}}" class="date" href="https://web.yammer.com/main/threads/{{node.id}}">{{date node.updatedAt}}</a></span>
        <span class="right floated">
          {{&likes node.threadStarter.reactionsConnection}}
        </span>
      </div>
      <div class="description">
        <p class="excerpt" data-content="{{body node.threadStarter}}" data-variation="wide inverted">{{first node.threadStarter}}</p>
      </div>
    </div>
    <div class="extra content">
      <div class="center aligned author">
        <img class="ui avatar image" src="{{avatar node.threadStarter.sender}}" onerror="this.src='/static/default-avatar.png'"> <a href="https://web.yammer.com/main/users/{{node.threadStarter.sender.id}}">{{node.threadStarter.sender.displayName}}</a>
      </div>
    </div>
  </div>
{{/each}}

{{#if errors}}
  <div class="ui negative message">
    <div class="header">An error occurred when loading the messages</div>
    <ul class="list">
      {{#each errors}}
        <li>{{.}}</li>
      {{/each}}
    </ul>
  </div>
{{/if}}